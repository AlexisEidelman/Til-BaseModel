# second entity, links, link methods, init, procedures, local variables,
# dump's suffix argument, choice


import:
    - _Individu/individu.yml
    - _Individu/register.yml
    - _House/menage.yml
    - _Fiscal/declar.yml
    - _Work/work_PensIPP.yml  # work0, work_pensIPP
    - _Work/income2.yml
    - _Demo/_birth/birth.yml
    - _Demo/_migration/migration.yml
    - _Demo/_death/death.yml
    - _Demo/_union/union.yml
    - _Demo/_divorce/divorce.yml
    - _Educ/youth.yml
    - _House/moving.yml
    - _Consumption/conso.yml
    - _Wealth/save.yml
    - _Jobs/companies.yml

globals:
    periodic:
       path: param/globals.csv
       fields:
       - MINR: float
       - WEMRA: int

simulation:
    init:
        - menage: [init_weight_men, init_region_id, init_rent, init_value, init_wealth, init_owner, men_composition]
        - individu: [init_weight_ind, init_couple, init_education_level, init_productivity]
        - companies: [init_size]
        - declar: [cases,empty_declar]
        - register: [init_reg]
        # - legislation: [2009]
        - register: [sum_indiv]
        - individu: [stat_period_ini, stat_period]

    processes:
    # apres chaque étape qui modifie les ménages, on fait tourner une moulinette sur declar et menage, pour s'assurer qu'on a les bons
    # vous et pref, plus tard, quand le code le permettra, on changera ce vous directement dans l'étape au niveau individu
        # - individu: [age, dump_info, show_demography , marriage]
        - register: [rien]
        - individu: [ageing]
        - individu: [death]
#        - individu: [migration]
        - individu: [check]
        - individu: [independance]
        - individu: [check]
        - individu: [birth]
        - individu: [check]
        - menage: [men_composition]
        - declar: [cases,empty_declar]
        - individu: [[into_couple, 'year']]
        - individu: [move_together]
        - individu: [check]
        - individu: [legal_union]
        - individu: [check]
        # - register: [sum_indiv]
        - menage: [[men_composition, 'year']]
        - declar: [[cases, 'year']]
        - declar: [[empty_declar, 'year']]
        - individu: [divorce]
        - individu: [check]
        - menage: [men_composition]
        - declar: [cases,empty_declar]
        - individu: [ineducation, outwork, inwork, retire, chomage, salaire , retraite
#            dump_all
        ]
        - individu: [check]
        - menage: [init_value, consumption, saving]
        - companies: [rien]
        # - legislation: [2009] #[annee leg] = année de départ de la simulation
        # - register: [alive]
        # - register: [sum_indiv]
        - individu: [stat_period]
    # final_stat: True
    # input:
    #   file: Patrimoine_1300.h5
    output:
       file: simul.h5

    skip_shows: True
    timings: False
    # time_scale: 'year'
    # retro: True


    start_period: 200801
    # first simulated period is start_period + 1  TODO: a bit ugly !

    periods: 5
